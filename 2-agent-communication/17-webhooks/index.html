<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Enterprise-grade Agent Development Kit for building, deploying, and orchestrating AI agents"><meta name=author content="Xians.ai Team"><link href=https://docs.xians.ai/2-agent-communication/17-webhooks/ rel=canonical><link href=../11-thread-and-scope/ rel=prev><link href=../10-handling-data-rpc/ rel=next><link rel=icon href=../../assets/logo.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>Webhooks - Xians.ai Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style><link rel=stylesheet href=../../css/timeago.css><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=deep-purple> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#webhooks class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Xians.ai Documentation" class="md-header__button md-logo" aria-label="Xians.ai Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2M7.5 13A2.5 2.5 0 0 0 5 15.5 2.5 2.5 0 0 0 7.5 18a2.5 2.5 0 0 0 2.5-2.5A2.5 2.5 0 0 0 7.5 13m9 0a2.5 2.5 0 0 0-2.5 2.5 2.5 2.5 0 0 0 2.5 2.5 2.5 2.5 0 0 0 2.5-2.5 2.5 2.5 0 0 0-2.5-2.5"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Xians.ai Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Webhooks </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=deep-purple aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/XiansAiPlatform/XiansAi.PublicDocs title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> XiansAiPlatform/XiansAi.PublicDocs </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../0-architecture/1-why-xians-platform/ class=md-tabs__link> Architecture </a> </li> <li class=md-tabs__item> <a href=../../1-getting-started/0-platform-setup/ class=md-tabs__link> Quick Start </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../13-message-types/ class=md-tabs__link> Agent Interactions </a> </li> <li class=md-tabs__item> <a href=../../4-automation/0-introduction/ class=md-tabs__link> Agent Automation </a> </li> <li class=md-tabs__item> <a href=../../3-knowledge/6-types-of-memory/ class=md-tabs__link> Agent Memory </a> </li> <li class=md-tabs__item> <a href=../../5-inference/orchestrator-selection/ class=md-tabs__link> LLM Inference </a> </li> <li class=md-tabs__item> <a href=../../n-encyclopedia/user-auth-config/ class=md-tabs__link> Encyclopedia </a> </li> <li class=md-tabs__item> <a href=../../platform-development/setup/ class=md-tabs__link> Platform Development </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Xians.ai Documentation" class="md-nav__button md-logo" aria-label="Xians.ai Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2M7.5 13A2.5 2.5 0 0 0 5 15.5 2.5 2.5 0 0 0 7.5 18a2.5 2.5 0 0 0 2.5-2.5A2.5 2.5 0 0 0 7.5 13m9 0a2.5 2.5 0 0 0-2.5 2.5 2.5 2.5 0 0 0 2.5 2.5 2.5 2.5 0 0 0 2.5-2.5 2.5 2.5 0 0 0-2.5-2.5"/></svg> </a> Xians.ai Documentation </label> <div class=md-nav__source> <a href=https://github.com/XiansAiPlatform/XiansAi.PublicDocs title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> XiansAiPlatform/XiansAi.PublicDocs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../0-architecture/1-why-xians-platform/ class=md-nav__link> <span class=md-ellipsis> Why Agentic Platforms </span> </a> </li> <li class=md-nav__item> <a href=../../0-architecture/2-platform-components/ class=md-nav__link> <span class=md-ellipsis> Xians Platform Components </span> </a> </li> <li class=md-nav__item> <a href=../../0-architecture/3-xians-core-features/ class=md-nav__link> <span class=md-ellipsis> Xians Features </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Quick Start </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Quick Start </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../1-getting-started/0-platform-setup/ class=md-nav__link> <span class=md-ellipsis> Platform Setup </span> </a> </li> <li class=md-nav__item> <a href=../../1-getting-started/1-agent-project-setting-up/ class=md-nav__link> <span class=md-ellipsis> Agent Project Setup </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Non-Deterministic </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Non-Deterministic </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../1-getting-started/2-first-agent/ class=md-nav__link> <span class=md-ellipsis> Conversational Flow </span> </a> </li> <li class=md-nav__item> <a href=../../1-getting-started/3-adding-capabilities/ class=md-nav__link> <span class=md-ellipsis> Adding Capabilities </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Deterministic </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Deterministic </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../1-getting-started/4-new-business-process/ class=md-nav__link> <span class=md-ellipsis> Business Process Flows </span> </a> </li> <li class=md-nav__item> <a href=../../1-getting-started/5-adding-activities/ class=md-nav__link> <span class=md-ellipsis> Adding Activities (Deprecated) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Agent Interactions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Agent Interactions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../13-message-types/ class=md-nav__link> <span class=md-ellipsis> Chat & Data Types </span> </a> </li> <li class=md-nav__item> <a href=../11-thread-and-scope/ class=md-nav__link> <span class=md-ellipsis> Threads & Scopes </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3 id=__nav_4_3_label tabindex> <span class=md-ellipsis> User 2 Agent </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> User 2 Agent </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://github.com/XiansAiPlatform/sdk-web-typescript class=md-nav__link> <span class=md-ellipsis> TypeScript SDK </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/XiansAiPlatform/XiansAi.Server/blob/main/XiansAi.Server.Src/docs/user-api/index.md class=md-nav__link> <span class=md-ellipsis> HTTP APIs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_4 checked> <label class=md-nav__link for=__nav_4_4 id=__nav_4_4_label tabindex> <span class=md-ellipsis> Machine 2 Agent </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Machine 2 Agent </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Webhooks </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Webhooks </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#webhook-url-format class=md-nav__link> <span class=md-ellipsis> Webhook URL Format </span> </a> <nav class=md-nav aria-label="Webhook URL Format"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#url-parameters class=md-nav__link> <span class=md-ellipsis> URL Parameters </span> </a> </li> <li class=md-nav__item> <a href=#example-urls class=md-nav__link> <span class=md-ellipsis> Example URLs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#implementing-webhook-handlers class=md-nav__link> <span class=md-ellipsis> Implementing Webhook Handlers </span> </a> <nav class=md-nav aria-label="Implementing Webhook Handlers"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-define-webhook-method class=md-nav__link> <span class=md-ellipsis> 1. Define Webhook Method </span> </a> </li> <li class=md-nav__item> <a href=#2-method-signature-requirements class=md-nav__link> <span class=md-ellipsis> 2. Method Signature Requirements </span> </a> </li> <li class=md-nav__item> <a href=#webhookresponse-class class=md-nav__link> <span class=md-ellipsis> WebhookResponse Class </span> </a> </li> <li class=md-nav__item> <a href=#3-complete-webhook-bot-example class=md-nav__link> <span class=md-ellipsis> 3. Complete Webhook Bot Example </span> </a> </li> <li class=md-nav__item> <a href=#understanding-initwebhookprocessing class=md-nav__link> <span class=md-ellipsis> Understanding InitWebhookProcessing() </span> </a> <nav class=md-nav aria-label="Understanding InitWebhookProcessing()"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-keeps-workflow-active-for-webhook-processing class=md-nav__link> <span class=md-ellipsis> 1. Keeps Workflow Active for Webhook Processing </span> </a> </li> <li class=md-nav__item> <a href=#2-temporal-maintenance-continueasnew class=md-nav__link> <span class=md-ellipsis> 2. Temporal Maintenance (ContinueAsNew) </span> </a> </li> <li class=md-nav__item> <a href=#3-alternative-asynchronous-initialization class=md-nav__link> <span class=md-ellipsis> 3. Alternative: Asynchronous Initialization </span> </a> </li> <li class=md-nav__item> <a href=#4-best-practices class=md-nav__link> <span class=md-ellipsis> 4. Best Practices </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#agent-configuration class=md-nav__link> <span class=md-ellipsis> Agent Configuration </span> </a> </li> <li class=md-nav__item> <a href=#webhook-security class=md-nav__link> <span class=md-ellipsis> Webhook Security </span> </a> <nav class=md-nav aria-label="Webhook Security"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#api-key-authentication class=md-nav__link> <span class=md-ellipsis> API Key Authentication </span> </a> </li> <li class=md-nav__item> <a href=#tenant-isolation class=md-nav__link> <span class=md-ellipsis> Tenant Isolation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-webhooks class=md-nav__link> <span class=md-ellipsis> Testing Webhooks </span> </a> <nav class=md-nav aria-label="Testing Webhooks"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-curl class=md-nav__link> <span class=md-ellipsis> Using cURL </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-use-cases class=md-nav__link> <span class=md-ellipsis> Common Use Cases </span> </a> <nav class=md-nav aria-label="Common Use Cases"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-email-integration class=md-nav__link> <span class=md-ellipsis> 1. Email Integration </span> </a> </li> <li class=md-nav__item> <a href=#2-payment-notifications class=md-nav__link> <span class=md-ellipsis> 2. Payment Notifications </span> </a> </li> <li class=md-nav__item> <a href=#3-system-monitoring class=md-nav__link> <span class=md-ellipsis> 3. System Monitoring </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> <nav class=md-nav aria-label="Best Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-error-handling class=md-nav__link> <span class=md-ellipsis> 1. Error Handling </span> </a> </li> <li class=md-nav__item> <a href=#2-async-processing class=md-nav__link> <span class=md-ellipsis> 2. Async Processing </span> </a> </li> <li class=md-nav__item> <a href=#3-validation class=md-nav__link> <span class=md-ellipsis> 3. Validation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#integration-with-other-agent-features class=md-nav__link> <span class=md-ellipsis> Integration with Other Agent Features </span> </a> <nav class=md-nav aria-label="Integration with Other Agent Features"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#combining-with-proactive-messages class=md-nav__link> <span class=md-ellipsis> Combining with Proactive Messages </span> </a> </li> <li class=md-nav__item> <a href=#triggering-agent-to-agent-communication class=md-nav__link> <span class=md-ellipsis> Triggering Agent-to-Agent Communication </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#architecture-notes class=md-nav__link> <span class=md-ellipsis> Architecture Notes </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../10-handling-data-rpc/ class=md-nav__link> <span class=md-ellipsis> Data RPC via REST </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5 id=__nav_4_5_label tabindex> <span class=md-ellipsis> Agent 2 User </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Agent 2 User </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../2-messaging/ class=md-nav__link> <span class=md-ellipsis> Sending Messages </span> </a> </li> <li class=md-nav__item> <a href=../4-responding/ class=md-nav__link> <span class=md-ellipsis> Responding to User </span> </a> </li> <li class=md-nav__item> <a href=../15-proactive-messages/ class=md-nav__link> <span class=md-ellipsis> Proactive Communication </span> </a> </li> <li class=md-nav__item> <a href=../5-skip-llm-response/ class=md-nav__link> <span class=md-ellipsis> Skip LLM Response </span> </a> </li> <li class=md-nav__item> <a href=../12-welcome-msg/ class=md-nav__link> <span class=md-ellipsis> Welcome Message </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_6> <label class=md-nav__link for=__nav_4_6 id=__nav_4_6_label tabindex> <span class=md-ellipsis> Agent 2 Agent </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_6_label aria-expanded=false> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Agent 2 Agent </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../16-synchronous-chat/ class=md-nav__link> <span class=md-ellipsis> Synchronous Chat </span> </a> </li> <li class=md-nav__item> <a href=../6-forward-message/ class=md-nav__link> <span class=md-ellipsis> Forwarding </span> </a> </li> <li class=md-nav__item> <a href=../16-synchronous-data-rpc/ class=md-nav__link> <span class=md-ellipsis> Synchronous Data RPC </span> </a> </li> <li class=md-nav__item> <a href=../1-events/ class=md-nav__link> <span class=md-ellipsis> Asynchronous Events </span> </a> </li> <li class=md-nav__item> <a href=../3-handoffs/ class=md-nav__link> <span class=md-ellipsis> Handoffs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_7> <label class=md-nav__link for=__nav_4_7 id=__nav_4_7_label tabindex> <span class=md-ellipsis> Advanced Topics </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_4_7> <span class="md-nav__icon md-icon"></span> Advanced Topics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../8-handling-data-messages/ class=md-nav__link> <span class=md-ellipsis> Data Events </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Agent Automation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Agent Automation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../4-automation/0-introduction/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../4-automation/1-external-triggers/ class=md-nav__link> <span class=md-ellipsis> External Triggers </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> Scheduling </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> Scheduling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../4-automation/2-flow-scheduling/ class=md-nav__link> <span class=md-ellipsis> Flow Scheduling </span> </a> </li> <li class=md-nav__item> <a href=../../4-automation/2-scheduling-sdk/ class=md-nav__link> <span class=md-ellipsis> Scheduling SDK </span> </a> </li> <li class=md-nav__item> <a href=../../4-automation/2-scheduled-execution/ class=md-nav__link> <span class=md-ellipsis> Scheduled Execution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../4-automation/3-fault-tolerance/ class=md-nav__link> <span class=md-ellipsis> Fault Tolerance </span> </a> </li> <li class=md-nav__item> <a href=../../4-automation/4-long-running-processes/ class=md-nav__link> <span class=md-ellipsis> Long-Running Processes </span> </a> </li> <li class=md-nav__item> <a href=../../4-automation/5-creating-sub-flows/ class=md-nav__link> <span class=md-ellipsis> Creating Sub-Flows </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Agent Memory </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Agent Memory </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../3-knowledge/6-types-of-memory/ class=md-nav__link> <span class=md-ellipsis> Types of Memory </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_2> <label class=md-nav__link for=__nav_6_2 id=__nav_6_2_label tabindex=0> <span class=md-ellipsis> Knowledge Prompts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> Knowledge Prompts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../3-knowledge/1-using-portal/ class=md-nav__link> <span class=md-ellipsis> Managing Knowledge </span> </a> </li> <li class=md-nav__item> <a href=../../3-knowledge/2-accessing-knowledge/ class=md-nav__link> <span class=md-ellipsis> Accessing Knowledge </span> </a> </li> <li class=md-nav__item> <a href=../../3-knowledge/3-capabilities/ class=md-nav__link> <span class=md-ellipsis> Capabilities as Knowledge </span> </a> </li> <li class=md-nav__item> <a href=../../3-knowledge/4-local-dev/ class=md-nav__link> <span class=md-ellipsis> Local Development </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> <span class=md-ellipsis> Structured Memory </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> Structured Memory </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../3-knowledge/5-document-store/ class=md-nav__link> <span class=md-ellipsis> Document Store </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> LLM Inference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> LLM Inference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../5-inference/orchestrator-selection/ class=md-nav__link> <span class=md-ellipsis> Orchestrator Selection </span> </a> </li> <li class=md-nav__item> <a href=../../5-inference/llm-completion/ class=md-nav__link> <span class=md-ellipsis> LLM Completion </span> </a> </li> <li class=md-nav__item> <a href=../../5-inference/configure-llm-provider/ class=md-nav__link> <span class=md-ellipsis> Configure LLM Provider </span> </a> </li> <li class=md-nav__item> <a href=../../5-inference/mcp-integration/ class=md-nav__link> <span class=md-ellipsis> MCP Integration </span> </a> </li> <li class=md-nav__item> <a href=../../5-inference/limiting-chat-router-tokens/ class=md-nav__link> <span class=md-ellipsis> Limiting Token Usage </span> </a> </li> <li class=md-nav__item> <a href=../../5-inference/7-chat-interceptors/ class=md-nav__link> <span class=md-ellipsis> Intercept Chat </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Encyclopedia </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Encyclopedia </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../n-encyclopedia/user-auth-config/ class=md-nav__link> <span class=md-ellipsis> User Auth Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/chat-message-encryption/ class=md-nav__link> <span class=md-ellipsis> Chat Message Encryption </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/retry-policy/ class=md-nav__link> <span class=md-ellipsis> Retry Policy </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/logging/ class=md-nav__link> <span class=md-ellipsis> Logging </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/agent-context/ class=md-nav__link> <span class=md-ellipsis> AgentContext </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/workflow-identification-utility/ class=md-nav__link> <span class=md-ellipsis> Workflow Utility </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/agent-context-utility/ class=md-nav__link> <span class=md-ellipsis> Agent Context Utility </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/multi-flow-agents/ class=md-nav__link> <span class=md-ellipsis> Multi-flow Agents </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/scaling-agents/ class=md-nav__link> <span class=md-ellipsis> Scaling Agent Flows </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/wf-best-practices/ class=md-nav__link> <span class=md-ellipsis> Workflow Best Practices </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/unit-testing/ class=md-nav__link> <span class=md-ellipsis> Unit Testing </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/unit-testing-activities/ class=md-nav__link> <span class=md-ellipsis> Unit Testing Activities </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/deployment-options/ class=md-nav__link> <span class=md-ellipsis> Agent Deployment </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/system-scoped-agents/ class=md-nav__link> <span class=md-ellipsis> System-Scoped Agents </span> </a> </li> <li class=md-nav__item> <a href=../../n-encyclopedia/access-agents-via-websocket/ class=md-nav__link> <span class=md-ellipsis> WebSocket Access </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <label class=md-nav__link for=__nav_9 id=__nav_9_label tabindex=0> <span class=md-ellipsis> Platform Development </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Platform Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../platform-development/setup/ class=md-nav__link> <span class=md-ellipsis> Start </span> </a> </li> <li class=md-nav__item> <a href=../../platform-development/learning-path/ class=md-nav__link> <span class=md-ellipsis> Learning Path </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#webhook-url-format class=md-nav__link> <span class=md-ellipsis> Webhook URL Format </span> </a> <nav class=md-nav aria-label="Webhook URL Format"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#url-parameters class=md-nav__link> <span class=md-ellipsis> URL Parameters </span> </a> </li> <li class=md-nav__item> <a href=#example-urls class=md-nav__link> <span class=md-ellipsis> Example URLs </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#implementing-webhook-handlers class=md-nav__link> <span class=md-ellipsis> Implementing Webhook Handlers </span> </a> <nav class=md-nav aria-label="Implementing Webhook Handlers"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-define-webhook-method class=md-nav__link> <span class=md-ellipsis> 1. Define Webhook Method </span> </a> </li> <li class=md-nav__item> <a href=#2-method-signature-requirements class=md-nav__link> <span class=md-ellipsis> 2. Method Signature Requirements </span> </a> </li> <li class=md-nav__item> <a href=#webhookresponse-class class=md-nav__link> <span class=md-ellipsis> WebhookResponse Class </span> </a> </li> <li class=md-nav__item> <a href=#3-complete-webhook-bot-example class=md-nav__link> <span class=md-ellipsis> 3. Complete Webhook Bot Example </span> </a> </li> <li class=md-nav__item> <a href=#understanding-initwebhookprocessing class=md-nav__link> <span class=md-ellipsis> Understanding InitWebhookProcessing() </span> </a> <nav class=md-nav aria-label="Understanding InitWebhookProcessing()"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-keeps-workflow-active-for-webhook-processing class=md-nav__link> <span class=md-ellipsis> 1. Keeps Workflow Active for Webhook Processing </span> </a> </li> <li class=md-nav__item> <a href=#2-temporal-maintenance-continueasnew class=md-nav__link> <span class=md-ellipsis> 2. Temporal Maintenance (ContinueAsNew) </span> </a> </li> <li class=md-nav__item> <a href=#3-alternative-asynchronous-initialization class=md-nav__link> <span class=md-ellipsis> 3. Alternative: Asynchronous Initialization </span> </a> </li> <li class=md-nav__item> <a href=#4-best-practices class=md-nav__link> <span class=md-ellipsis> 4. Best Practices </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#agent-configuration class=md-nav__link> <span class=md-ellipsis> Agent Configuration </span> </a> </li> <li class=md-nav__item> <a href=#webhook-security class=md-nav__link> <span class=md-ellipsis> Webhook Security </span> </a> <nav class=md-nav aria-label="Webhook Security"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#api-key-authentication class=md-nav__link> <span class=md-ellipsis> API Key Authentication </span> </a> </li> <li class=md-nav__item> <a href=#tenant-isolation class=md-nav__link> <span class=md-ellipsis> Tenant Isolation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-webhooks class=md-nav__link> <span class=md-ellipsis> Testing Webhooks </span> </a> <nav class=md-nav aria-label="Testing Webhooks"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#using-curl class=md-nav__link> <span class=md-ellipsis> Using cURL </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#common-use-cases class=md-nav__link> <span class=md-ellipsis> Common Use Cases </span> </a> <nav class=md-nav aria-label="Common Use Cases"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-email-integration class=md-nav__link> <span class=md-ellipsis> 1. Email Integration </span> </a> </li> <li class=md-nav__item> <a href=#2-payment-notifications class=md-nav__link> <span class=md-ellipsis> 2. Payment Notifications </span> </a> </li> <li class=md-nav__item> <a href=#3-system-monitoring class=md-nav__link> <span class=md-ellipsis> 3. System Monitoring </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#best-practices class=md-nav__link> <span class=md-ellipsis> Best Practices </span> </a> <nav class=md-nav aria-label="Best Practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-error-handling class=md-nav__link> <span class=md-ellipsis> 1. Error Handling </span> </a> </li> <li class=md-nav__item> <a href=#2-async-processing class=md-nav__link> <span class=md-ellipsis> 2. Async Processing </span> </a> </li> <li class=md-nav__item> <a href=#3-validation class=md-nav__link> <span class=md-ellipsis> 3. Validation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#integration-with-other-agent-features class=md-nav__link> <span class=md-ellipsis> Integration with Other Agent Features </span> </a> <nav class=md-nav aria-label="Integration with Other Agent Features"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#combining-with-proactive-messages class=md-nav__link> <span class=md-ellipsis> Combining with Proactive Messages </span> </a> </li> <li class=md-nav__item> <a href=#triggering-agent-to-agent-communication class=md-nav__link> <span class=md-ellipsis> Triggering Agent-to-Agent Communication </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#architecture-notes class=md-nav__link> <span class=md-ellipsis> Architecture Notes </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/XiansAiPlatform/XiansAi.PublicDocs/edit/main/docs/2-agent-communication/17-webhooks.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <a href=https://github.com/XiansAiPlatform/XiansAi.PublicDocs/raw/main/docs/2-agent-communication/17-webhooks.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg> </a> <h1 id=webhooks>Webhooks<a class=headerlink href=#webhooks title="Permalink to this section">&para;</a></h1> <p>Webhooks provide a powerful mechanism for external systems to send messages and trigger events in your XiansAI agents. They enable real-time integration with third-party services, allowing your agents to respond to external events as they occur.</p> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permalink to this section">&para;</a></h2> <p>Webhooks in XiansAI allow external systems to:</p> <ul> <li>Send HTTP POST requests to trigger agent workflows</li> <li>Pass data and parameters to agent methods</li> <li>Receive immediate responses from agents</li> <li>Integrate with external services and APIs</li> </ul> <h2 id=webhook-url-format>Webhook URL Format<a class=headerlink href=#webhook-url-format title="Permalink to this section">&para;</a></h2> <p>All webhook requests follow this standardized URL format:</p> <div class="language-http highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=err>POST &lt;server-url&gt;/api/user/webhooks/{workflow}/{methodName}?apikey={apikey}&amp;[additional-params]</span>
</span></code></pre></div> <h3 id=url-parameters>URL Parameters<a class=headerlink href=#url-parameters title="Permalink to this section">&para;</a></h3> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> <th>Required</th> </tr> </thead> <tbody> <tr> <td><code>workflow</code></td> <td>Either the WorkflowId or the WorkflowType</td> <td>✅ Yes</td> </tr> <tr> <td><code>methodName</code></td> <td>Name of the Temporal Update method to invoke</td> <td>✅ Yes</td> </tr> <tr> <td><code>apikey</code></td> <td>Valid API key for authentication</td> <td>✅ Yes</td> </tr> <tr> <td><code>tenantId</code></td> <td>Tenant identifier (automatically derived from API key if not provided)</td> <td>❌ Optional*</td> </tr> <tr> <td><code>additional-params</code></td> <td>Custom query parameters passed to the method</td> <td>❌ Optional</td> </tr> </tbody> </table> <p>*The tenant is automatically determined from the API key. You can optionally provide <code>tenantId</code> for backward compatibility, but it must match the API key's tenant.</p> <h3 id=example-urls>Example URLs<a class=headerlink href=#example-urls title="Permalink to this section">&para;</a></h3> <p><strong>Recommended (secure):</strong> <div class="language-http highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=err>POST http://localhost:5000/api/user/webhooks/A2A%20Agent%20Team%3A%20Webhook%20Bot/mail-received?apikey=sk-Xnai-jJlpoIrOxiAhrOwOsB1xuO96TfEfZYmJa2u6xMqXjZg&amp;param=param-value</span>
</span></code></pre></div></p> <p><strong>Legacy (with explicit tenantId):</strong> <div class="language-http highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=err>POST http://localhost:5000/api/user/webhooks/A2A%20Agent%20Team%3A%20Webhook%20Bot/mail-received?apikey=sk-Xnai-jJlpoIrOxiAhrOwOsB1xuO96TfEfZYmJa2u6xMqXjZg&amp;tenantId=default&amp;param=param-value</span>
</span></code></pre></div></p> <h2 id=implementing-webhook-handlers>Implementing Webhook Handlers<a class=headerlink href=#implementing-webhook-handlers title="Permalink to this section">&para;</a></h2> <h3 id=1-define-webhook-method>1. Define Webhook Method<a class=headerlink href=#1-define-webhook-method title="Permalink to this section">&para;</a></h3> <p>Create a method in your workflow class decorated with the <code>[WorkflowUpdate]</code> attribute:</p> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=na>[WorkflowUpdate(&quot;method-name&quot;)]</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>WebhookUpdateMethod</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=p>{</span>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>    </span><span class=c1>// Process the webhook data</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>    </span><span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&quot;Webhook received&quot;</span><span class=p>);</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w>    </span><span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=n>queryParams</span><span class=p>));</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>    </span><span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>    </span><span class=c1>// Return response to webhook caller</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=w>    </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Webhook processed successfully&quot;</span><span class=p>;</span>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=p>}</span>
</span></code></pre></div> <h3 id=2-method-signature-requirements>2. Method Signature Requirements<a class=headerlink href=#2-method-signature-requirements title="Permalink to this section">&para;</a></h3> <ul> <li><strong>Update Name</strong>: Must match the <code>methodName</code> in the webhook URL</li> <li><strong>Parameters</strong>:</li> <li><code>queryParams</code>: Contains all query parameters except <code>apikey</code> (and <code>tenantId</code> if provided)</li> <li><code>body</code>: Contains the raw request body as a string</li> <li><strong>Return Type</strong>: Must return a <code>WebhookResponse</code> object which allows you to control the HTTP status code, content, and content type sent back to the webhook caller.</li> </ul> <h3 id=webhookresponse-class>WebhookResponse Class<a class=headerlink href=#webhookresponse-class title="Permalink to this section">&para;</a></h3> <p>The <code>WebhookResponse</code> class provides fine-grained control over the HTTP response sent back to the webhook caller:</p> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1>// Basic response with 200 OK status</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Success message&quot;</span><span class=p>;</span>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=c1>// Response with custom status code</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=kt>var</span><span class=w> </span><span class=n>errorResponse</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>BadRequest</span><span class=p>);</span>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=n>errorResponse</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>error</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Invalid data&quot;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=c1>// Response with custom content type</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=kt>var</span><span class=w> </span><span class=n>xmlResponse</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>,</span><span class=w> </span><span class=s>&quot;&lt;result&gt;success&lt;/result&gt;&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;application/xml&quot;</span><span class=p>);</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=c1>// Plain text response (useful for validation tokens)</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=kt>var</span><span class=w> </span><span class=n>validationResponse</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>,</span><span class=w> </span><span class=s>&quot;validation-token-123&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;text/plain&quot;</span><span class=p>);</span>
</span></code></pre></div> <p><strong>Constructor Options:</strong></p> <ul> <li><code>WebhookResponse(HttpStatusCode statusCode)</code> - Basic response with status code</li> <li><code>WebhookResponse(HttpStatusCode statusCode, string content, string contentType)</code> - Full control over response</li> </ul> <p><strong>Properties:</strong></p> <ul> <li><code>StatusCode</code> - HTTP status code (200, 400, 500, etc.)</li> <li><code>Content</code> - Response body content</li> <li><code>ContentType</code> - MIME type (defaults to "application/json")</li> </ul> <h3 id=3-complete-webhook-bot-example>3. Complete Webhook Bot Example<a class=headerlink href=#3-complete-webhook-bot-example title="Permalink to this section">&para;</a></h3> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>using</span><span class=w> </span><span class=nn>System.Text.Json</span><span class=p>;</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=k>using</span><span class=w> </span><span class=nn>System.Net</span><span class=p>;</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=k>using</span><span class=w> </span><span class=nn>Temporalio.Workflows</span><span class=p>;</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=k>using</span><span class=w> </span><span class=nn>XiansAi.Flow</span><span class=p>;</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=na>[Workflow(&quot;Agent Team: Webhook Bot&quot;)]</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=k>public</span><span class=w> </span><span class=k>class</span><span class=w> </span><span class=nc>WebhookBot</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>FlowBase</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=p>{</span>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>    </span><span class=na>[WorkflowRun]</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>    </span><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=w> </span><span class=nf>Run</span><span class=p>()</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=w>        </span><span class=k>await</span><span class=w> </span><span class=nf>InitWebhookProcessing</span><span class=p>();</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=w>    </span><span class=na>[WorkflowUpdate(&quot;mail-received&quot;)]</span>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=w>    </span><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>MailReceived</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=w>        </span><span class=c1>// Optional: Add processing delay</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=w>        </span><span class=k>await</span><span class=w> </span><span class=n>Workflow</span><span class=p>.</span><span class=n>DelayAsync</span><span class=p>(</span><span class=n>TimeSpan</span><span class=p>.</span><span class=n>FromSeconds</span><span class=p>(</span><span class=mi>1</span><span class=p>));</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=w>        </span><span class=c1>// Handle validation token (for services like Microsoft Graph)</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>queryParams</span><span class=p>.</span><span class=n>TryGetValue</span><span class=p>(</span><span class=s>&quot;validationToken&quot;</span><span class=p>,</span><span class=w> </span><span class=k>out</span><span class=w> </span><span class=kt>var</span><span class=w> </span><span class=n>validationToken</span><span class=p>))</span>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=w>        </span><span class=p>{</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=nf>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>,</span><span class=w> </span><span class=n>validationToken</span><span class=p>,</span><span class=w> </span><span class=s>&quot;text/plain&quot;</span><span class=p>);</span>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a>
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=w>        </span><span class=c1>// Log webhook reception</span>
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=w>        </span><span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&quot;Mail received&quot;</span><span class=p>);</span>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a><span class=w>        </span><span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=n>queryParams</span><span class=p>));</span>
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a><span class=w>        </span><span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a>
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a><span class=w>        </span><span class=c1>// Process the webhook data here</span>
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a><span class=w>        </span><span class=c1>// ... your business logic ...</span>
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a>
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a><span class=w>        </span><span class=c1>// Return response to caller</span>
</span><span id=__span-5-36><a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a><span class=w>        </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-5-37><a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a><span class=w>        </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>body</span><span class=p>;</span><span class=w> </span><span class=c1>// Echo back the received body</span>
</span><span id=__span-5-38><a id=__codelineno-5-38 name=__codelineno-5-38 href=#__codelineno-5-38></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-5-39><a id=__codelineno-5-39 name=__codelineno-5-39 href=#__codelineno-5-39></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-5-40><a id=__codelineno-5-40 name=__codelineno-5-40 href=#__codelineno-5-40></a>
</span><span id=__span-5-41><a id=__codelineno-5-41 name=__codelineno-5-41 href=#__codelineno-5-41></a><span class=w>    </span><span class=na>[WorkflowUpdate(&quot;order-created&quot;)]</span>
</span><span id=__span-5-42><a id=__codelineno-5-42 name=__codelineno-5-42 href=#__codelineno-5-42></a><span class=w>    </span><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>OrderCreated</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-5-43><a id=__codelineno-5-43 name=__codelineno-5-43 href=#__codelineno-5-43></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-5-44><a id=__codelineno-5-44 name=__codelineno-5-44 href=#__codelineno-5-44></a><span class=w>        </span><span class=c1>// Parse JSON body</span>
</span><span id=__span-5-45><a id=__codelineno-5-45 name=__codelineno-5-45 href=#__codelineno-5-45></a><span class=w>        </span><span class=kt>var</span><span class=w> </span><span class=n>orderData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Deserialize</span><span class=o>&lt;</span><span class=n>OrderData</span><span class=o>&gt;</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-5-46><a id=__codelineno-5-46 name=__codelineno-5-46 href=#__codelineno-5-46></a>
</span><span id=__span-5-47><a id=__codelineno-5-47 name=__codelineno-5-47 href=#__codelineno-5-47></a><span class=w>        </span><span class=c1>// Process order</span>
</span><span id=__span-5-48><a id=__codelineno-5-48 name=__codelineno-5-48 href=#__codelineno-5-48></a><span class=w>        </span><span class=k>await</span><span class=w> </span><span class=nf>ProcessOrder</span><span class=p>(</span><span class=n>orderData</span><span class=p>);</span>
</span><span id=__span-5-49><a id=__codelineno-5-49 name=__codelineno-5-49 href=#__codelineno-5-49></a>
</span><span id=__span-5-50><a id=__codelineno-5-50 name=__codelineno-5-50 href=#__codelineno-5-50></a><span class=w>        </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-5-51><a id=__codelineno-5-51 name=__codelineno-5-51 href=#__codelineno-5-51></a><span class=w>        </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;processed&quot;</span><span class=p>,</span><span class=w> </span><span class=n>orderId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>orderData</span><span class=p>.</span><span class=n>Id</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-5-52><a id=__codelineno-5-52 name=__codelineno-5-52 href=#__codelineno-5-52></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-5-53><a id=__codelineno-5-53 name=__codelineno-5-53 href=#__codelineno-5-53></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-5-54><a id=__codelineno-5-54 name=__codelineno-5-54 href=#__codelineno-5-54></a>
</span><span id=__span-5-55><a id=__codelineno-5-55 name=__codelineno-5-55 href=#__codelineno-5-55></a><span class=w>    </span><span class=k>private</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=w> </span><span class=nf>ProcessOrder</span><span class=p>(</span><span class=n>OrderData</span><span class=w> </span><span class=n>order</span><span class=p>)</span>
</span><span id=__span-5-56><a id=__codelineno-5-56 name=__codelineno-5-56 href=#__codelineno-5-56></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-5-57><a id=__codelineno-5-57 name=__codelineno-5-57 href=#__codelineno-5-57></a><span class=w>        </span><span class=c1>// Your order processing logic</span>
</span><span id=__span-5-58><a id=__codelineno-5-58 name=__codelineno-5-58 href=#__codelineno-5-58></a><span class=w>        </span><span class=k>await</span><span class=w> </span><span class=n>Workflow</span><span class=p>.</span><span class=n>DelayAsync</span><span class=p>(</span><span class=n>TimeSpan</span><span class=p>.</span><span class=n>FromSeconds</span><span class=p>(</span><span class=mi>2</span><span class=p>));</span>
</span><span id=__span-5-59><a id=__codelineno-5-59 name=__codelineno-5-59 href=#__codelineno-5-59></a><span class=w>        </span><span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>$&quot;Processed order: {order.Id}&quot;</span><span class=p>);</span>
</span><span id=__span-5-60><a id=__codelineno-5-60 name=__codelineno-5-60 href=#__codelineno-5-60></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-5-61><a id=__codelineno-5-61 name=__codelineno-5-61 href=#__codelineno-5-61></a><span class=p>}</span>
</span><span id=__span-5-62><a id=__codelineno-5-62 name=__codelineno-5-62 href=#__codelineno-5-62></a>
</span><span id=__span-5-63><a id=__codelineno-5-63 name=__codelineno-5-63 href=#__codelineno-5-63></a><span class=k>public</span><span class=w> </span><span class=k>class</span><span class=w> </span><span class=nc>OrderData</span>
</span><span id=__span-5-64><a id=__codelineno-5-64 name=__codelineno-5-64 href=#__codelineno-5-64></a><span class=p>{</span>
</span><span id=__span-5-65><a id=__codelineno-5-65 name=__codelineno-5-65 href=#__codelineno-5-65></a><span class=w>    </span><span class=k>public</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>Id</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>get</span><span class=p>;</span><span class=w> </span><span class=k>set</span><span class=p>;</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-5-66><a id=__codelineno-5-66 name=__codelineno-5-66 href=#__codelineno-5-66></a><span class=w>    </span><span class=k>public</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>CustomerEmail</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>get</span><span class=p>;</span><span class=w> </span><span class=k>set</span><span class=p>;</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-5-67><a id=__codelineno-5-67 name=__codelineno-5-67 href=#__codelineno-5-67></a><span class=w>    </span><span class=k>public</span><span class=w> </span><span class=kt>decimal</span><span class=w> </span><span class=n>Amount</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=k>get</span><span class=p>;</span><span class=w> </span><span class=k>set</span><span class=p>;</span><span class=w> </span><span class=p>}</span>
</span><span id=__span-5-68><a id=__codelineno-5-68 name=__codelineno-5-68 href=#__codelineno-5-68></a><span class=p>}</span>
</span></code></pre></div> <h3 id=understanding-initwebhookprocessing>Understanding InitWebhookProcessing()<a class=headerlink href=#understanding-initwebhookprocessing title="Permalink to this section">&para;</a></h3> <p>The <code>await InitWebhookProcessing()</code> call in the workflow's <code>Run()</code> method serves several critical functions:</p> <h4 id=1-keeps-workflow-active-for-webhook-processing>1. Keeps Workflow Active for Webhook Processing<a class=headerlink href=#1-keeps-workflow-active-for-webhook-processing title="Permalink to this section">&para;</a></h4> <p>This method holds the workflow indefinitely from completion, allowing it to continue processing incoming webhook requests. Without this call, the workflow would complete immediately and wouldn't be able to handle webhook updates.</p> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=na>[WorkflowRun]</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=w> </span><span class=nf>Run</span><span class=p>()</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=p>{</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=nf>InitWebhookProcessing</span><span class=p>();</span><span class=w> </span><span class=c1>// Keeps workflow alive to handle webhooks</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=p>}</span>
</span></code></pre></div> <h4 id=2-temporal-maintenance-continueasnew>2. Temporal Maintenance (ContinueAsNew)<a class=headerlink href=#2-temporal-maintenance-continueasnew title="Permalink to this section">&para;</a></h4> <p><code>InitWebhookProcessing()</code> performs mandatory Temporal maintenance by automatically calling <code>ContinueAsNew</code> when the workflow history becomes too long. This prevents workflows from hitting Temporal's history size limits and ensures optimal performance.</p> <h4 id=3-alternative-asynchronous-initialization>3. Alternative: Asynchronous Initialization<a class=headerlink href=#3-alternative-asynchronous-initialization title="Permalink to this section">&para;</a></h4> <p>While any workflow can process webhooks, it's a good practice to initialize webhook processing asynchronously if you have other workflow logic to execute:</p> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=na>[WorkflowRun]</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=w> </span><span class=nf>Run</span><span class=p>()</span>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=p>{</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>    </span><span class=c1>// Start webhook processing asynchronously (fire-and-forget)</span>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>    </span><span class=n>_</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>InitWebhookProcessing</span><span class=p>();</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=w>    </span><span class=c1>// Continue with other workflow logic</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=nf>PerformOtherTasks</span><span class=p>();</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=w>    </span><span class=c1>// Keep workflow running</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=n>Workflow</span><span class=p>.</span><span class=n>WaitConditionAsync</span><span class=p>(()</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=k>false</span><span class=p>);</span><span class=w> </span><span class=c1>// Wait indefinitely</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=p>}</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=k>private</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=w> </span><span class=nf>PerformOtherTasks</span><span class=p>()</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=p>{</span>
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=w>    </span><span class=c1>// Your other workflow logic here</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=nf>SomeInitializationTask</span><span class=p>();</span>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=nf>SetupPeriodicTasks</span><span class=p>();</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=p>}</span>
</span></code></pre></div> <h4 id=4-best-practices>4. Best Practices<a class=headerlink href=#4-best-practices title="Permalink to this section">&para;</a></h4> <ul> <li><strong>Dedicated Webhook Workflows</strong>: For workflows that only handle webhooks, use <code>await InitWebhookProcessing()</code></li> <li><strong>Mixed Workflows</strong>: For workflows with other logic, use <code>_ = InitWebhookProcessing()</code> and manage the workflow lifecycle separately</li> <li><strong>Always Keep Active</strong>: Ensure your webhook workflow never completes if you want to continue receiving webhook calls</li> </ul> <div class="admonition info"> <p class=admonition-title>Workflow Lifecycle and Webhook Processing</p> <p>If your webhook workflow completes (exits the <code>Run()</code> method), the system will automatically start a new workflow instance each time a webhook request is received. This "Update with Start" pattern ensures webhooks are always processed, but creates overhead from repeatedly starting new workflow instances.</p> <p>For optimal performance with frequent webhooks, keep your workflow active using <code>InitWebhookProcessing()</code> to maintain a single long-running instance.</p> </div> <h2 id=agent-configuration>Agent Configuration<a class=headerlink href=#agent-configuration title="Permalink to this section">&para;</a></h2> <p>Register your webhook bot with the agent:</p> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=k>using</span><span class=w> </span><span class=nn>XiansAi.Flow</span><span class=p>;</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=k>using</span><span class=w> </span><span class=nn>DotNetEnv</span><span class=p>;</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=c1>// Load environment variables</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=n>Env</span><span class=p>.</span><span class=n>Load</span><span class=p>();</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=c1>// Create agent</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=kt>var</span><span class=w> </span><span class=n>agent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>AgentTeam</span><span class=p>(</span><span class=s>&quot;Agent Team&quot;</span><span class=p>);</span>
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=c1>// Add webhook bot</span>
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=kt>var</span><span class=w> </span><span class=n>webhookBot</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>agent</span><span class=p>.</span><span class=n>AddAgent</span><span class=o>&lt;</span><span class=n>WebhookBot</span><span class=o>&gt;</span><span class=p>();</span>
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=c1>// Run agent</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=k>await</span><span class=w> </span><span class=n>agent</span><span class=p>.</span><span class=n>RunAsync</span><span class=p>();</span>
</span></code></pre></div> <h2 id=webhook-security>Webhook Security<a class=headerlink href=#webhook-security title="Permalink to this section">&para;</a></h2> <h3 id=api-key-authentication>API Key Authentication<a class=headerlink href=#api-key-authentication title="Permalink to this section">&para;</a></h3> <p>All webhook requests must include a valid API key in the query parameters:</p> <div class="language-http highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=err>?apikey=&lt;your-api-key&gt;</span>
</span></code></pre></div> <p>The API key provides both authentication and authorization. The system automatically extracts the tenant information from the authenticated API key, ensuring secure tenant isolation.</p> <h3 id=tenant-isolation>Tenant Isolation<a class=headerlink href=#tenant-isolation title="Permalink to this section">&para;</a></h3> <p>Webhooks are automatically tenant-scoped based on the authenticated API key. The tenant associated with the API key is used to identify and route the webhook to the correct workflow instance.</p> <p><strong>Security Best Practice:</strong> Do not include the <code>tenantId</code> parameter in your webhook URLs. Let the system derive it from your API key to prevent potential security issues.</p> <p><strong>Legacy Support:</strong> If you need to include <code>tenantId</code> for backward compatibility, it must exactly match the tenant associated with your API key, otherwise the request will be rejected.</p> <h2 id=testing-webhooks>Testing Webhooks<a class=headerlink href=#testing-webhooks title="Permalink to this section">&para;</a></h2> <h3 id=using-curl>Using cURL<a class=headerlink href=#using-curl title="Permalink to this section">&para;</a></h3> <div class="language-bash highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>curl<span class=w> </span>-X<span class=w> </span>POST<span class=w> </span><span class=se>\</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>  </span>-H<span class=w> </span><span class=s2>&quot;Content-Type: application/json&quot;</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>  </span>-d<span class=w> </span><span class=s1>&#39;{&quot;message&quot;: &quot;Test message&quot;, &quot;timestamp&quot;: &quot;2024-01-15T10:30:00Z&quot;}&#39;</span><span class=w> </span><span class=se>\</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>  </span><span class=s2>&quot;http://localhost:5000/api/user/webhooks/WebhookBot/mail-received?apikey=your-api-key&amp;source=email&quot;</span>
</span></code></pre></div> <p><strong>Note:</strong> The tenant is automatically derived from your API key. You don't need to include <code>tenantId</code> in the URL.</p> <h2 id=common-use-cases>Common Use Cases<a class=headerlink href=#common-use-cases title="Permalink to this section">&para;</a></h2> <h3 id=1-email-integration>1. Email Integration<a class=headerlink href=#1-email-integration title="Permalink to this section">&para;</a></h3> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=na>[WorkflowUpdate(&quot;email-received&quot;)]</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>EmailReceived</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=p>{</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>emailData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Deserialize</span><span class=o>&lt;</span><span class=n>EmailData</span><span class=o>&gt;</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span><span class=c1>// Process email</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=nf>ProcessEmail</span><span class=p>(</span><span class=n>emailData</span><span class=p>);</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=w>    </span><span class=c1>// Send to appropriate agent</span>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=n>MessageHub</span><span class=p>.</span><span class=n>Agent2Agent</span><span class=p>.</span><span class=n>SendChat</span><span class=p>(</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=w>        </span><span class=k>typeof</span><span class=p>(</span><span class=n>CustomerServiceAgent</span><span class=p>),</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=w>        </span><span class=s>$&quot;New email from {emailData.From}: {emailData.Subject}&quot;</span>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=w>    </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Email processed&quot;</span><span class=p>;</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=p>}</span>
</span></code></pre></div> <h3 id=2-payment-notifications>2. Payment Notifications<a class=headerlink href=#2-payment-notifications title="Permalink to this section">&para;</a></h3> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=na>[WorkflowUpdate(&quot;payment-completed&quot;)]</span>
</span><span id=__span-12-2><a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>PaymentCompleted</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-12-3><a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=p>{</span>
</span><span id=__span-12-4><a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>payment</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Deserialize</span><span class=o>&lt;</span><span class=n>PaymentNotification</span><span class=o>&gt;</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-12-5><a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a>
</span><span id=__span-12-6><a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=w>    </span><span class=c1>// Update order status</span>
</span><span id=__span-12-7><a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=nf>UpdateOrderStatus</span><span class=p>(</span><span class=n>payment</span><span class=p>.</span><span class=n>OrderId</span><span class=p>,</span><span class=w> </span><span class=s>&quot;paid&quot;</span><span class=p>);</span>
</span><span id=__span-12-8><a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a>
</span><span id=__span-12-9><a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=w>    </span><span class=c1>// Trigger fulfillment</span>
</span><span id=__span-12-10><a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=n>MessageHub</span><span class=p>.</span><span class=n>Agent2Agent</span><span class=p>.</span><span class=n>SendData</span><span class=p>(</span>
</span><span id=__span-12-11><a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=w>        </span><span class=k>typeof</span><span class=p>(</span><span class=n>FulfillmentAgent</span><span class=p>),</span>
</span><span id=__span-12-12><a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=w>        </span><span class=k>new</span><span class=w> </span><span class=n>FulfillmentRequest</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>OrderId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>payment</span><span class=p>.</span><span class=n>OrderId</span><span class=w> </span><span class=p>},</span>
</span><span id=__span-12-13><a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=w>        </span><span class=s>&quot;ProcessFulfillment&quot;</span>
</span><span id=__span-12-14><a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-12-15><a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a>
</span><span id=__span-12-16><a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-12-17><a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a><span class=w>    </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;processed&quot;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-12-18><a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-12-19><a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a><span class=p>}</span>
</span></code></pre></div> <h3 id=3-system-monitoring>3. System Monitoring<a class=headerlink href=#3-system-monitoring title="Permalink to this section">&para;</a></h3> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=na>[WorkflowUpdate(&quot;system-alert&quot;)]</span>
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>SystemAlert</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=p>{</span>
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>alert</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Deserialize</span><span class=o>&lt;</span><span class=n>SystemAlert</span><span class=o>&gt;</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>
</span><span id=__span-13-6><a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>alert</span><span class=p>.</span><span class=n>Severity</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&quot;critical&quot;</span><span class=p>)</span>
</span><span id=__span-13-7><a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-13-8><a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=w>        </span><span class=c1>// Escalate to on-call engineer</span>
</span><span id=__span-13-9><a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=w>        </span><span class=k>await</span><span class=w> </span><span class=n>MessageHub</span><span class=p>.</span><span class=n>Agent2User</span><span class=p>.</span><span class=n>SendChat</span><span class=p>(</span>
</span><span id=__span-13-10><a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=w>            </span><span class=n>alert</span><span class=p>.</span><span class=n>OnCallEngineerId</span><span class=p>,</span>
</span><span id=__span-13-11><a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=w>            </span><span class=s>$&quot;🚨 Critical Alert: {alert.Message}&quot;</span>
</span><span id=__span-13-12><a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=w>        </span><span class=p>);</span>
</span><span id=__span-13-13><a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-13-14><a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>
</span><span id=__span-13-15><a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=w>    </span><span class=c1>// Log alert</span>
</span><span id=__span-13-16><a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=w>    </span><span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>$&quot;Alert received: {alert.Message}&quot;</span><span class=p>);</span>
</span><span id=__span-13-17><a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a>
</span><span id=__span-13-18><a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-13-19><a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a><span class=w>    </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Alert acknowledged&quot;</span><span class=p>;</span>
</span><span id=__span-13-20><a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-13-21><a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a><span class=p>}</span>
</span></code></pre></div> <h2 id=best-practices>Best Practices<a class=headerlink href=#best-practices title="Permalink to this section">&para;</a></h2> <h3 id=1-error-handling>1. Error Handling<a class=headerlink href=#1-error-handling title="Permalink to this section">&para;</a></h3> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=na>[WorkflowUpdate(&quot;process-data&quot;)]</span>
</span><span id=__span-14-2><a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>ProcessData</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-14-3><a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=p>{</span>
</span><span id=__span-14-4><a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=w>    </span><span class=k>try</span>
</span><span id=__span-14-5><a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-14-6><a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=w>        </span><span class=kt>var</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Deserialize</span><span class=o>&lt;</span><span class=n>MyData</span><span class=o>&gt;</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-14-7><a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=w>        </span><span class=k>await</span><span class=w> </span><span class=nf>ProcessBusinessLogic</span><span class=p>(</span><span class=n>data</span><span class=p>);</span>
</span><span id=__span-14-8><a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>
</span><span id=__span-14-9><a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=w>        </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-14-10><a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=w>        </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;success&quot;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-14-11><a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-14-12><a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-14-13><a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=w>    </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>JsonException</span><span class=w> </span><span class=n>ex</span><span class=p>)</span>
</span><span id=__span-14-14><a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-14-15><a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=w>        </span><span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>$&quot;JSON parsing error: {ex.Message}&quot;</span><span class=p>);</span>
</span><span id=__span-14-16><a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a>
</span><span id=__span-14-17><a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=w>        </span><span class=kt>var</span><span class=w> </span><span class=n>errorResponse</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>BadRequest</span><span class=p>);</span>
</span><span id=__span-14-18><a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=w>        </span><span class=n>errorResponse</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;error&quot;</span><span class=p>,</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Invalid JSON format&quot;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-14-19><a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>errorResponse</span><span class=p>;</span>
</span><span id=__span-14-20><a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-14-21><a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a><span class=w>    </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>ex</span><span class=p>)</span>
</span><span id=__span-14-22><a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-14-23><a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a><span class=w>        </span><span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>$&quot;Processing error: {ex.Message}&quot;</span><span class=p>);</span>
</span><span id=__span-14-24><a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a>
</span><span id=__span-14-25><a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a><span class=w>        </span><span class=kt>var</span><span class=w> </span><span class=n>errorResponse</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>InternalServerError</span><span class=p>);</span>
</span><span id=__span-14-26><a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a><span class=w>        </span><span class=n>errorResponse</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;error&quot;</span><span class=p>,</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Processing failed&quot;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-14-27><a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>errorResponse</span><span class=p>;</span>
</span><span id=__span-14-28><a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-14-29><a id=__codelineno-14-29 name=__codelineno-14-29 href=#__codelineno-14-29></a><span class=p>}</span>
</span></code></pre></div> <h3 id=2-async-processing>2. Async Processing<a class=headerlink href=#2-async-processing title="Permalink to this section">&para;</a></h3> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=na>[WorkflowUpdate(&quot;long-running-task&quot;)]</span>
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>LongRunningTask</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=p>{</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=w>    </span><span class=c1>// Start async processing</span>
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=w>    </span><span class=n>_</span><span class=w> </span><span class=o>=</span><span class=w>  </span><span class=n>Workflow</span><span class=p>.</span><span class=n>RunTaskAsync</span><span class=p>(</span><span class=k>async</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>=&gt;</span>
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=w>        </span><span class=k>await</span><span class=w> </span><span class=nf>ProcessLongRunningTask</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=w>    </span><span class=p>});</span>
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a>
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=w>    </span><span class=c1>// Return immediate response</span>
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>Accepted</span><span class=p>);</span>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=w>    </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;accepted&quot;</span><span class=p>,</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Task queued for processing&quot;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-15-13><a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-15-14><a id=__codelineno-15-14 name=__codelineno-15-14 href=#__codelineno-15-14></a><span class=p>}</span>
</span></code></pre></div> <h3 id=3-validation>3. Validation<a class=headerlink href=#3-validation title="Permalink to this section">&para;</a></h3> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=na>[WorkflowUpdate(&quot;validate-and-process&quot;)]</span>
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>ValidateAndProcess</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=p>{</span>
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>    </span><span class=c1>// Validate required parameters</span>
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>queryParams</span><span class=p>.</span><span class=n>ContainsKey</span><span class=p>(</span><span class=s>&quot;source&quot;</span><span class=p>))</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=w>        </span><span class=kt>var</span><span class=w> </span><span class=n>errorResponse</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>BadRequest</span><span class=p>);</span>
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=w>        </span><span class=n>errorResponse</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;error&quot;</span><span class=p>,</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Missing &#39;source&#39; parameter&quot;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>errorResponse</span><span class=p>;</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=w>    </span><span class=c1>// Validate body</span>
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=kt>string</span><span class=p>.</span><span class=n>IsNullOrEmpty</span><span class=p>(</span><span class=n>body</span><span class=p>))</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=w>        </span><span class=kt>var</span><span class=w> </span><span class=n>errorResponse</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>BadRequest</span><span class=p>);</span>
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=w>        </span><span class=n>errorResponse</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;error&quot;</span><span class=p>,</span><span class=w> </span><span class=n>message</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Empty request body&quot;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>errorResponse</span><span class=p>;</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-16-19><a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>
</span><span id=__span-16-20><a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a><span class=w>    </span><span class=c1>// Process valid request</span>
</span><span id=__span-16-21><a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=nf>ProcessValidRequest</span><span class=p>(</span><span class=n>queryParams</span><span class=p>[</span><span class=s>&quot;source&quot;</span><span class=p>],</span><span class=w> </span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-16-22><a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a>
</span><span id=__span-16-23><a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-16-24><a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a><span class=w>    </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Serialize</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;success&quot;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-16-25><a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-16-26><a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a><span class=p>}</span>
</span></code></pre></div> <h2 id=integration-with-other-agent-features>Integration with Other Agent Features<a class=headerlink href=#integration-with-other-agent-features title="Permalink to this section">&para;</a></h2> <h3 id=combining-with-proactive-messages>Combining with Proactive Messages<a class=headerlink href=#combining-with-proactive-messages title="Permalink to this section">&para;</a></h3> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-17-1><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=na>[WorkflowUpdate(&quot;user-action&quot;)]</span>
</span><span id=__span-17-2><a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>UserAction</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-17-3><a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=p>{</span>
</span><span id=__span-17-4><a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>action</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Deserialize</span><span class=o>&lt;</span><span class=n>UserAction</span><span class=o>&gt;</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-17-5><a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>
</span><span id=__span-17-6><a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=w>    </span><span class=c1>// Send proactive message to user</span>
</span><span id=__span-17-7><a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=w>    </span><span class=k>await</span><span class=w> </span><span class=n>MessageHub</span><span class=p>.</span><span class=n>Agent2User</span><span class=p>.</span><span class=n>SendChat</span><span class=p>(</span>
</span><span id=__span-17-8><a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a><span class=w>        </span><span class=n>action</span><span class=p>.</span><span class=n>UserId</span><span class=p>,</span>
</span><span id=__span-17-9><a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=w>        </span><span class=s>$&quot;We received your {action.ActionType} request and are processing it now.&quot;</span>
</span><span id=__span-17-10><a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a><span class=w>    </span><span class=p>);</span>
</span><span id=__span-17-11><a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a>
</span><span id=__span-17-12><a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-17-13><a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=w>    </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Action acknowledged&quot;</span><span class=p>;</span>
</span><span id=__span-17-14><a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-17-15><a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=p>}</span>
</span></code></pre></div> <h3 id=triggering-agent-to-agent-communication>Triggering Agent-to-Agent Communication<a class=headerlink href=#triggering-agent-to-agent-communication title="Permalink to this section">&para;</a></h3> <div class="language-csharp highlight"><pre><span></span><code><span id=__span-18-1><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=na>[WorkflowUpdate(&quot;external-event&quot;)]</span>
</span><span id=__span-18-2><a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=k>public</span><span class=w> </span><span class=k>async</span><span class=w> </span><span class=n>Task</span><span class=o>&lt;</span><span class=n>WebhookResponse</span><span class=o>&gt;</span><span class=w> </span><span class=n>ExternalEvent</span><span class=p>(</span><span class=n>IDictionary</span><span class=o>&lt;</span><span class=kt>string</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>queryParams</span><span class=p>,</span><span class=w> </span><span class=kt>string</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-18-3><a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=p>{</span>
</span><span id=__span-18-4><a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>eventData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>JsonSerializer</span><span class=p>.</span><span class=n>Deserialize</span><span class=o>&lt;</span><span class=n>ExternalEvent</span><span class=o>&gt;</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-18-5><a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>
</span><span id=__span-18-6><a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=w>    </span><span class=c1>// Route to appropriate agent based on event type</span>
</span><span id=__span-18-7><a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a><span class=w>    </span><span class=k>switch</span><span class=w> </span><span class=p>(</span><span class=n>eventData</span><span class=p>.</span><span class=n>Type</span><span class=p>)</span>
</span><span id=__span-18-8><a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-18-9><a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=w>        </span><span class=k>case</span><span class=w> </span><span class=s>&quot;order&quot;</span><span class=p>:</span>
</span><span id=__span-18-10><a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=w>            </span><span class=k>await</span><span class=w> </span><span class=n>MessageHub</span><span class=p>.</span><span class=n>Agent2Agent</span><span class=p>.</span><span class=n>SendData</span><span class=p>(</span>
</span><span id=__span-18-11><a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a><span class=w>                </span><span class=k>typeof</span><span class=p>(</span><span class=n>OrderProcessingAgent</span><span class=p>),</span>
</span><span id=__span-18-12><a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a><span class=w>                </span><span class=n>eventData</span><span class=p>.</span><span class=n>Data</span><span class=p>,</span>
</span><span id=__span-18-13><a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a><span class=w>                </span><span class=s>&quot;ProcessOrder&quot;</span>
</span><span id=__span-18-14><a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a><span class=w>            </span><span class=p>);</span>
</span><span id=__span-18-15><a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a><span class=w>            </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-18-16><a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a>
</span><span id=__span-18-17><a id=__codelineno-18-17 name=__codelineno-18-17 href=#__codelineno-18-17></a><span class=w>        </span><span class=k>case</span><span class=w> </span><span class=s>&quot;support&quot;</span><span class=p>:</span>
</span><span id=__span-18-18><a id=__codelineno-18-18 name=__codelineno-18-18 href=#__codelineno-18-18></a><span class=w>            </span><span class=k>await</span><span class=w> </span><span class=n>MessageHub</span><span class=p>.</span><span class=n>Agent2Agent</span><span class=p>.</span><span class=n>SendChat</span><span class=p>(</span>
</span><span id=__span-18-19><a id=__codelineno-18-19 name=__codelineno-18-19 href=#__codelineno-18-19></a><span class=w>                </span><span class=k>typeof</span><span class=p>(</span><span class=n>CustomerSupportAgent</span><span class=p>),</span>
</span><span id=__span-18-20><a id=__codelineno-18-20 name=__codelineno-18-20 href=#__codelineno-18-20></a><span class=w>                </span><span class=n>eventData</span><span class=p>.</span><span class=n>Message</span>
</span><span id=__span-18-21><a id=__codelineno-18-21 name=__codelineno-18-21 href=#__codelineno-18-21></a><span class=w>            </span><span class=p>);</span>
</span><span id=__span-18-22><a id=__codelineno-18-22 name=__codelineno-18-22 href=#__codelineno-18-22></a><span class=w>            </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-18-23><a id=__codelineno-18-23 name=__codelineno-18-23 href=#__codelineno-18-23></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-18-24><a id=__codelineno-18-24 name=__codelineno-18-24 href=#__codelineno-18-24></a>
</span><span id=__span-18-25><a id=__codelineno-18-25 name=__codelineno-18-25 href=#__codelineno-18-25></a><span class=w>    </span><span class=kt>var</span><span class=w> </span><span class=n>response</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>WebhookResponse</span><span class=p>(</span><span class=n>HttpStatusCode</span><span class=p>.</span><span class=n>OK</span><span class=p>);</span>
</span><span id=__span-18-26><a id=__codelineno-18-26 name=__codelineno-18-26 href=#__codelineno-18-26></a><span class=w>    </span><span class=n>response</span><span class=p>.</span><span class=n>Content</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Event routed successfully&quot;</span><span class=p>;</span>
</span><span id=__span-18-27><a id=__codelineno-18-27 name=__codelineno-18-27 href=#__codelineno-18-27></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>response</span><span class=p>;</span>
</span><span id=__span-18-28><a id=__codelineno-18-28 name=__codelineno-18-28 href=#__codelineno-18-28></a><span class=p>}</span>
</span></code></pre></div> <h2 id=architecture-notes>Architecture Notes<a class=headerlink href=#architecture-notes title="Permalink to this section">&para;</a></h2> <p>Webhooks use the Temporal "Update with Start" pattern, which provides automatic workflow lifecycle management:</p> <ul> <li><strong>Workflow Running</strong>: If the target workflow is already running, the webhook update method is called on the existing instance</li> <li><strong>Workflow Not Running</strong>: If no workflow instance exists, the system automatically starts a new workflow instance and then calls the webhook update method</li> <li><strong>Guaranteed Processing</strong>: This ensures that webhook requests are never lost, regardless of workflow state</li> </ul> <div class="admonition tip"> <p class=admonition-title>Performance Considerations</p> <p>Webhooks hold HTTP connections until the workflow method completes. For long-running processes, consider returning an immediate acknowledgment and processing asynchronously. Webhook requests will timeout in 30 seconds by default.</p> </div> <div class="admonition example"> <p class=admonition-title>Complete Sample</p> <p>See the complete webhook implementation example in the <a href=https://github.com/XiansAiPlatform/samples/tree/main/a2a-communications>A2A Communications Sample</a> repository.</p> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 29, 2025 12:19:55 UTC"><span class=timeago datetime=2025-10-29T12:19:55+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 29, 2025 12:19:55 UTC">2025-10-29</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 29, 2025 12:19:55 UTC"><span class=timeago datetime=2025-10-29T12:19:55+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 29, 2025 12:19:55 UTC">2025-10-29</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2024 <a href=https://xians.ai target=_blank rel=noopener>Xians.ai</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href=#__consent>Manage Cookies</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href=https://xians.ai/privacy target=_blank rel=noopener>Privacy Policy</a> &nbsp;&nbsp;&nbsp;&nbsp; <a href=https://xians.ai/terms target=_blank rel=noopener>Terms of Service</a> </div> </div> <div class=md-social> <a href=https://github.com/XiansAiPlatform target=_blank rel=noopener title="GitHub Organization" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://discord.gg/xians target=_blank rel=noopener title="Discord Community" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg> </a> <a href=https://twitter.com/xiansai target=_blank rel=noopener title=Twitter class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg> </a> <a href=https://xians.ai target=_blank rel=noopener title="Official Website" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M351.9 280H161c2.9 64.5 17.2 123.9 37.5 167.4 11.4 24.5 23.7 41.8 35.1 52.4 11.2 10.5 18.9 12.2 22.9 12.2s11.7-1.7 22.9-12.2c11.4-10.6 23.7-28 35.1-52.4 20.3-43.5 34.6-102.9 37.5-167.4zm-191-48h190.9c-2.8-64.5-17.1-123.9-37.4-167.4-11.4-24.4-23.7-41.8-35.1-52.4C268.1 1.7 260.4 0 256.4 0s-11.7 1.7-22.9 12.2c-11.4 10.6-23.7 28-35.1 52.4-20.3 43.5-34.6 102.9-37.5 167.4m-48 0c3.5-85.6 25.6-165.1 57.9-217.3C78.7 47.3 10.9 131.2 1.5 232zM1.5 280c9.4 100.8 77.2 184.7 169.3 217.3-32.3-52.2-54.4-131.7-57.9-217.3zm398.4 0c-3.5 85.6-25.6 165.1-57.9 217.3 92.1-32.7 159.9-116.5 169.3-217.3zm111.4-48C501.9 131.2 434.1 47.3 342 14.7c32.3 52.2 54.4 131.7 57.9 217.3z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top", "navigation.tracking", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "search.suggest", "search.highlight", "search.share", "content.tabs.link", "content.code.annotation", "content.code.copy", "content.action.edit", "content.action.view", "content.tooltips", "header.autohide", "announce.dismiss", "toc.follow"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../js/timeago.min.js></script> <script src=../../js/timeago_mkdocs_material.js></script> <script src=../../javascripts/external-links.js></script> <script src=../../javascripts/code-expand.js></script> </body> </html>